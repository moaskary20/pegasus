# โ ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ (FAQ)

## 1. ูุง ุฃุฌุฏ ุงูุฎูุงุฑ ุงูุฌุฏูุฏ ูู ูููุฐุฌ ุงูุฏุฑุณ!

### ๐ ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:

#### ุงูุณุจุจ 1: Migration ูู ุชูุดุบูู
```bash
# ุชุญูู ูู ุญุงูุฉ Migration
php artisan migrate:status

# ุฅุฐุง ูุงูุช Pendingุ ุดุบูููุง:
php artisan migrate
```

#### ุงูุณุจุจ 2: ุงูู Cache ูููุนูู
```bash
# ูุณุญ ุฌููุน ุฃููุงุน ุงูู Cache
php artisan cache:clear
php artisan config:clear
php artisan view:clear
```

#### ุงูุณุจุจ 3: ูุชุตูุญ ุงููุฏูู
- ุงุถุบุท **Ctrl+Shift+Del** (ุฃู Cmd+Shift+Del ุนูู Mac)
- ุงูุณุญ ุจูุงูุงุช ุงููุชุตูุญ
- ุฃุนุฏ ุชุญููู ุงูุตูุญุฉ (F5)

---

## 2. ููู ุฃุชุฃูุฏ ูู ุฃู ุงูุญูู ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุชุ

```bash
# ุงุณุชุฎุฏู Tinker ููุชุญูู
php artisan tinker

# ุฃุฏุฎู ุงูุฃูุงูุฑ:
>>> \App\Models\Lesson::first()->can_unlock_without_completion
# ูุฌุจ ุฃู ููุฑุฌุน: 0 (false)

>>> exit
```

---

## 3. ุงูุฎูุงุฑ ูุธูุฑ ููู ูุง ููุญูุธ!

### ๐ ุงูุญู:

#### ุชุฃูุฏ ูู ุฃู ุงูู Model ูุญุฏูุซ
```php
// app/Models/Lesson.php
protected $fillable = [
    'section_id',
    'title',
    'description',
    // ... ุฌููุน ุงูุญููู ...
    'can_unlock_without_completion',  // โ ุชุฃูุฏ ูู ูุฌูุฏู
];
```

#### ูุณุญ ุงูู Cache ูู ุฌุฏูุฏ
```bash
php artisan cache:clear
php artisan config:clear
```

#### ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ
- ุงุถุบุท **Ctrl+F5** ุจุฏูุงู ูู **F5** (ุชุญููู ุตุงุฑู)

---

## 4. ุงูุทุงูุจ ููููู ูุชุญ ุงูุฏุฑุณ ุญุชู ูุน ุงูุชุนุทูู!

### ๐ ุงูุฃุณุจุงุจ:

#### ุงูุณุจุจ 1: Migration ูู ุชูุดุบูู ุจุดูู ุตุญูุญ
```bash
php artisan migrate:status
# ุชุฃูุฏ ุฃู Migration ูุดุบูู
```

#### ุงูุณุจุจ 2: ุงูุฏุฑุณ ูุฌุงูู
```php
// ูุฏ ูููู ุงูุฏุฑุณ ูุฌุงูู ุจุงููุนู
is_free = 1  // ุฃู
is_free_preview = 1
```

#### ุงูุณุจุจ 3: Enrollment ูุง ุชูุฌุฏ ุดุฑูุท
- ุชุฃูุฏ ูู ุฃู ุงูุทุงูุจ ูุดุชุฑู ูู ุงูุฏูุฑุฉ ุจุดูู ุตุญูุญ

#### ุงูุณุจุจ 4: ุงูุฏุฑูุณ ุงูุณุงุจูุฉ ููุชููุฉ ุจุงููุนู
```bash
php artisan tinker

>>> $user = \App\Models\User::find(USER_ID);
>>> $lesson = \App\Models\Lesson::find(LESSON_ID);
>>> $accessService = app(\App\Services\LessonAccessService::class);
>>> $accessService->canAccessLesson($user, $lesson);
# ูุฌุจ ุฃู ููุฑุฌุน: false
```

---

## 5. ููู ุฃุฎุชุจุฑ ุฃู ุงูููุฒุฉ ุชุนูู ุจุดูู ุตุญูุญุ

### ุงูุงุฎุชุจุงุฑ ุงููุงูู:

```bash
php artisan tinker

# 1. ุงุญุตู ุนูู ูุณุชุฎุฏู ูุฏุฑุณ
>>> $user = \App\Models\User::find(1);
>>> $lesson = \App\Models\Lesson::find(1);
>>> $previousLesson = \App\Models\Lesson::find(0);  # ุฏุฑุณ ุจุชุฑุชูุจ ุฃูู

# 2. ุงุฎุชุจุฑ ุงูุฎุฏูุฉ
>>> $accessService = app(\App\Services\LessonAccessService::class);

# 3. ุงูุชุญูู ูู ุฃู ุงูุฏุฑูุณ ุงูุณุงุจูุฉ ุบูุฑ ููุชููุฉ
>>> $incompleteLesson = $accessService->getFirstIncompleteLesson($user, $lesson);
>>> dump($incompleteLesson);

# 4. ุชุนุทูู ุงูุฎูุงุฑ (ุงูุงูุชุฑุงุถู)
>>> $lesson->can_unlock_without_completion = false;
>>> $lesson->save();

# 5. ุงูุชุญูู ูู ุนุฏู ุงููุตูู
>>> $accessService->canAccessLesson($user, $lesson);
# ูุฌุจ ุฃู ููุฑุฌุน: false

# 6. ุชูุนูู ุงูุฎูุงุฑ
>>> $lesson->can_unlock_without_completion = true;
>>> $lesson->save();

# 7. ุงูุชุญูู ูู ุงููุตูู
>>> $accessService->canAccessLesson($user, $lesson);
# ูุฌุจ ุฃู ููุฑุฌุน: true

>>> exit
```

---

## 6. ูู ุงูุฎูุงุฑ ูุคุซุฑ ุนูู ุฌููุน ุงูุทูุงุจุ

### ุงูุฅุฌุงุจุฉ: โ ูุนู

- ุงูุฎูุงุฑ ุนูู ูุณุชูู ุงูุฏุฑุณุ ููุณ ุนูู ูุณุชูู ุงูุทุงูุจ
- ุฌููุน ุงูุทูุงุจ ุงูุฐูู ูุฏุฑุณูู ููุณ ุงูุฏุฑุณ ุณูุชุฃุซุฑูู
- ูุง ุชูุฌุฏ ุงุณุชุซูุงุกุงุช ูุฑุฏูุฉ

---

## 7. ุฅุฐุง ูุงู ุงูุฏุฑุณ ูุฌุงููุ ูู ูุชุฌุงูุฒ ุงูุฎูุงุฑุ

### ุงูุฅุฌุงุจุฉ: โ ูุนู

- ุฅุฐุง ูุงู ุงูุฏุฑุณ ูุฌุงูู (`is_free = true`)
- ุงูุทุงูุจ ููููู ุงููุตูู ุจุฏูู ุฃู ุดุฑูุท
- ุงูุฎูุงุฑ ุงูุฌุฏูุฏ ูุง ูุคุซุฑ ุนูู ุงูุฏุฑูุณ ุงููุฌุงููุฉ

```php
// ูู LessonAccessService
if ($lesson->is_free || $lesson->is_free_preview) {
    return true;  // ูููู ุงููุตูู ุจุฏูู ุดุฑูุท
}
```

---

## 8. ูู ุงูุชุฑุชูุจ ููู ุฌุฏุงูุ

### ุงูุฅุฌุงุจุฉ: โ ูุนู ุฌุฏุงู!

- ุงููุธุงู ููุญุต ุงูุฏุฑูุณ ุญุณุจ `sort_order`
- ูุฌุจ ุฃู ูููู ุชุฑุชูุจ ุงูุฏุฑูุณ ุตุญูุญ
- ุฅุฐุง ูุงู ุชุฑุชูุจ ุฎุงุทุฆุ ุงููุญุต ูุฏ ูุง ูุนูู ุจุดูู ุตุญูุญ

```bash
# ุชุญูู ูู ุงูุชุฑุชูุจ
php artisan tinker

>>> \App\Models\Lesson::where('section_id', 1)
    ->orderBy('sort_order')
    ->get(['id', 'title', 'sort_order']);
# ูุฌุจ ุฃู ูุธูุฑ ุงูุชุฑุชูุจ ุจุดูู ููุทูู
```

---

## 9. ูุงุฐุง ูู ุฃุฑุฏุช ุงุณุชุซูุงุกุงุช ูุทูุงุจ ูุนููููุ

### ุงูุญู ุงูุญุงูู:
- ุงููุธุงู ุงูุญุงูู ูุง ูุฏุนู ุงุณุชุซูุงุกุงุช ูุฑุฏูุฉ
- ุฅุฐุง ุฃุฑุฏุช ุงุณุชุซูุงุกุงุชุ ูุฌุจ ุชุทููุฑ ุงูููุฒุฉ

### ุงูุชุทููุฑ ุงููุณุชูุจูู ุงูููุชุฑุญ:

1. ุฅุถุงูุฉ ุฌุฏูู `lesson_access_exceptions`
2. ุงูุณูุงุญ ูููุฏุฑุณ ุจุฅุถุงูุฉ ุงุณุชุซูุงุกุงุช ูุทูุงุจ ูุนูููู

```sql
CREATE TABLE lesson_access_exceptions (
    id INT PRIMARY KEY,
    user_id INT,
    lesson_id INT,
    can_access BOOLEAN,
    reason TEXT,
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);
```

---

## 10. ููู ุฃูุนุทูู ูุฐู ุงูููุฒุฉ ุฅุฐุง ุฃุฑุฏุชุ

### ุงูุทุฑููุฉ 1: ุชุนุทูู ูู ููุญุฉ ุงูุชุญูู
- ูุชุญ ุฌููุน ุงูุฏุฑูุณ ูู "ุฏุฑูุณ ูุฌุงููุฉ"
- ูุฐุง ุฃุณูู ูู ุญุฐู ุงูููุฒุฉ

### ุงูุทุฑููุฉ 2: ุญุฐู ุงูููุฒุฉ ุชูุงูุงู

```bash
# ุฅูุบุงุก Migration
php artisan migrate:rollback --step=1

# ุฃู ุญุฐู ุงููุฏูู:
# - ุญุฐู ุงูุญูู ูู LessonAccessService
# - ุญุฐู ุงูู Toggle ูู ุงูููุงุฐุฌ
# - ุญุฐู ุงูุนููุฏ ูู ุงูุฌุฏุงูู
```

---

## 11. ูู ููุงู ุชุฃุซูุฑ ุนูู ุงูุฃุฏุงุกุ

### ุงูุฅุฌุงุจุฉ: โ ุชุฃุซูุฑ ุถุฆูู ุฌุฏุงู

- ุงููุญุต ุจุณูุท ุฌุฏุงู (ููุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช)
- ูุง ุชูุฌุฏ loops ูุนูุฏุฉ
- ุงูุฃุฏุงุก ูุง ูุชุฃุซุฑ ุจุดูู ููุญูุธ

---

## 12. ููู ุฃูุนุฏูู ุฑุณุงูุฉ ุงูุฎุทุฃ ููุทุงูุจุ

### ุงูููู: `app/Filament/Pages/WatchVideo.php`

```php
\Filament\Notifications\Notification::make()
    ->title('ุบูุฑ ูุณููุญ ุจุงููุตูู')
    ->body(
        $incompleteLesson
            ? "ูุฌุจ ุนููู ุฅููุงู ุงูุฏุฑุณ: {$incompleteLesson->title}"
            : 'ูุฌุจ ุนููู ุฅููุงู ุงูุฏุฑูุณ ุงูุณุงุจูุฉ ุฃููุงู'
    )
    ->warning()
    ->send();
```

**ุนุฏูู ุงููุต ุญุณุจ ุงุญุชูุงุฌู**

---

## 13. ูู ูููู ุฅุถุงูุฉ ุฎูุงุฑุงุช ุฃุฎุฑู ูุซู ูุฐุงุ

### ุงูุฅุฌุงุจุฉ: โ ูุนู ุจุงูุชุฃููุฏ!

ุงูููุฒุฉ ูุงุจูุฉ ููุชูุณุน:

1. **ูุณุจุฉ ูุฌุงุญ ูู ุงูุงุฎุชุจุงุฑ:**
   - ุฅุฐุง ูู ููุฌุญ ุงูุทุงูุจ ูู ุงุฎุชุจุงุฑ ุงูุฏุฑุณ ุงูุณุงุจู ุจูุณุจุฉ 60%
   - ุงูุฏุฑุณ ุงูุชุงูู ุณูููู ููููู

2. **ุนุฏุฏ ุงููุงุฌุจุงุช:**
   - ุฅุฐุง ูู ูููู ุงูุทุงูุจ ูุงุฌุจุงุช ุงูุฏุฑุณ ุงูุณุงุจู
   - ุงูุฏุฑุณ ุงูุชุงูู ุณูููู ููููู

3. **ุดุฑูุท ุฒูููุฉ:**
   - ุฅุฐุง ูู ููุฌุญ ุงูุทุงูุจ ูู ูุฏุฉ ุฒูููุฉ ูุนููุฉ
   - ุงูุฏุฑุณ ุงูุชุงูู ุณูููู ููููู

---

## 14. ูู ููุงู logs ูุชุชุจุน ุงูุชุบููุฑุงุชุ

### ุงูุญุงูู: โ ูุง

ูููู ุฅุถุงูุฉ:

```php
// ูู LessonAccessService ุฃู Migration
// ุฅุถุงูุฉ ุฌุฏูู logs:
CREATE TABLE lesson_access_logs (
    id INT PRIMARY KEY,
    user_id INT,
    lesson_id INT,
    can_access BOOLEAN,
    reason TEXT,
    created_at TIMESTAMP
);
```

---

## 15. ููู ุฃุชูุงุตู ูุน ุงูุฏุนู ุงูููู ุฅุฐุง ูุงุฌูุช ูุดููุฉุ

### ูุจู ุงูุชูุงุตูุ ุฌุฑูุจ:

1. ุชุดุบูู Migration
2. ูุณุญ ุงูู Cache
3. ุชุญุฏูุซ ุงููุชุตูุญ (Ctrl+F5)
4. ุงูุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
5. ูุฑุงุกุฉ ูููุงุช ุงูู Logs (`storage/logs`)

### ูุนูููุงุช ูุฌุจ ุชูุฏูููุง:

```
- ุฑูู ุงูุฅุตุฏุงุฑ: 1.0.0
- ููุน ุงููุดููุฉ: [ุงุฎุชุฑ]
- ุงูุฏุฑุณ ุงููุชุฃุซุฑ: [ุงุณู ุงูุฏุฑุณ]
- ุงูุทุงูุจ ุงููุชุฃุซุฑ: [ID ุฃู ุงุณู]
- ุงูุฎุทูุงุช ุงูุชู ุงุชุจุนุชูุง: [ุงูุฎุทูุงุช]
- ุงูุฑุณุงูุฉ ุงููุนุฑูุถุฉ: [ุงูุฑุณุงูุฉ]
```

---

## ๐ฏ ุงูุฎูุงุตุฉ

| ุงููุดููุฉ | ุงูุญู |
|--------|------|
| ูุง ูุธูุฑ ุงูุฎูุงุฑ | ุชุดุบูู Migration + ูุณุญ Cache |
| ูุง ููุญูุธ ุงูุฎูุงุฑ | ุชุญุฏูุซ ุงูู Model + ูุณุญ Cache |
| ุงูุทุงูุจ ููููู ุงููุตูู | ุงูุชุญูู ูู ูููุฉ ุงูุฎูุงุฑ |
| ุฑุณุงูุฉ ุฎุทุฃ ุบุฑูุจุฉ | ูุฑุงุฌุนุฉ ุงูู Logs |
| ุฃุฏุงุก ุจุทูุก | ุชุญูู ูู ุนุฏุฏ ุงูุฏุฑูุณ |

---

**ุขุฎุฑ ุชุญุฏูุซ:** 29 ููุงูุฑ 2026  
**ุงูุฅุตุฏุงุฑ:** 1.0.0  
**ุงูุญุงูุฉ:** ุฌุงูุฒ ููุงุณุชุฎุฏุงู โ
